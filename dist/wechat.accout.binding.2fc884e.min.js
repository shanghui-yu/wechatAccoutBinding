!function(e){function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var t={};i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="",i(i.s=0)}([function(e,i,t){var a;!function(){function n(){void 0!==(a=function(e,i){var t=document.createElement("style"),a=document.createElement("link");a.rel="stylesheet",a.href="https://res.wx.qq.com/open/libs/weui/0.4.2/weui.min.css",document.head.appendChild(a),t.innerText='.truckhome-account-binding{position: fixed;left:0;top:0;width:100%;height:100%;overflow: hidden;background-color: #fbf9fe;z-index: 1001;visibility: hidden;opacity:0;pointer-events: none;-webkit-transform: translate3d(0,100%,0);transform: translate3d(0,100%,0);-webkit-transition: all .2s ease-out;transition: all .2s ease-out}.truckhome-account-binding.visible{-webkit-transform: translate3d(0,0,0);transform: translate3d(0,0,0);opacity: 1;visibility: visible;pointer-events: all;}.weui_vcode .weui_cell_ft .vcode{margin-left: 5px;width:107px;height: 44px;line-height:44px;vertical-align: middle;display:inline-block;color:#fff;font-size: 14px;text-align: center;background:rgba(4,190,2,1)}.weui_vcode .weui_cell_ft .vcode.disabled{color:#999;background: #f5f5f5}.truckhome-account-binding .weui_btn_area{display: -webkit-box;display: -webkit-flex;display: flex;}.truckhome-account-binding .weui_btn_area > *{-webkit-box-flex: 1;-webkit-flex: 1;flex: 1}.truckhome-account-binding .weui_btn_area input[type="submit"]{margin:0 0 0 10px;border-radius: 5px;}.truckhome-account-binding .weui_btn_area input[disabled]{opacity: 1}.truckhome-account-binding .weui_label{width:80px}',document.head.appendChild(t);var n='<form method="POST" action="https://sso.360che.com/index.php?c=login&m=login&auth=1" autocomplete="off">                <div class="weui_cells_title">手机号码绑定</div>                <div class="weui_cells weui_cells_form">                    <div class="weui_cell">                        <div class="weui_cell_hd"><label class="weui_label">手机号</label></div>                        <div class="weui_cell_bd weui_cell_primary">                            <input class="weui_input" type="tel" name="phone" placeholder="请输入手机号" maxlength="11" />                        </div>                        <div class="weui_cell_ft">                            <i class="weui_icon_warn"></i>                        </div>                    </div>                    <div class="weui_cell weui_vcode">                        <div class="weui_cell_hd"><label class="weui_label">验证码</label></div>                        <div class="weui_cell_bd weui_cell_primary">                            <input class="weui_input" type="tel" name="phonecode" placeholder="请输入验证码" value="" maxlength="4" />                        </div>                        <div class="weui_cell_ft">                            <i class="weui_icon_warn"></i>                            <span class="vcode">获取验证码</span>                        </div>                    </div>                </div>                <input type="hidden" name="referer" value="\'+ document.referrer ? document.referrer : location.href +\'" />                <div class="weui_btn_area">                    <a href="javascript:;" class="weui_btn weui_btn_default">取消</a>                    <input type="submit" class="weui_btn weui_btn_disabled weui_btn_primary" value="绑定" disabled />                </div>            </form>            <div class="weui_msg">                <div class="weui_extra_area">                    <a href="javascript:;" class="account_switch">卡车之家账号登录</a>                </div>            </div>',s=document.querySelector("#truckhome_account_binding"),l=document.cookie.match(/AbcfN_unionid=([^;$]+)/);l&&l[1]&&Object.defineProperty(window,"unionid",{writable:!1,value:l[1]}),s||(s=document.createElement("div"),s.className="truckhome-account-binding",s.addEventListener("touchmove",function(e){e.preventDefault()}),document.body.appendChild(s));var o={init:function(){window.bindUserid?this.BindStatus=!0:(this.mode="binding",s.classList.contains("visible")&&s.classList.remove("visible"),this.checkOAuth(),this.onInputHandle())},checkBind:function(){var e=this;$.ajax({url:"https://sso.360che.com/?c=user",dataType:"jsonp",success:function(i){if("err"==i.status){e.BindStatus=!1;try{var t=localStorage.getItem("truckhomeAccountBinding");t&&(t=JSON.parse(t),e.show(t.callback||""))}catch(e){}}else e.BindStatus=!0}})},checkOAuth:function(){var e=this;window.unionid?(this.OAuthStatus=!0,this.checkBind()):$.ajax({url:"https://sso.360che.com/index.php?c=weChatOauthUrl&m=getAuthUrl",dataType:"jsonp",success:function(i){"err"==i.status?(e.OAuthStatus=!0,e.checkBind()):(e.OAuthStatus=!1,e.OAuthUrl=i.info.url)}})},show:function(e){if(this.OAuthStatus){try{localStorage.getItem("truckhomeAccountBinding")&&localStorage.removeItem("truckhomeAccountBinding")}catch(e){}this.BindStatus?e&&Function.isFunction(e)&&e():(s.classList.add("visible"),location.hash="#"+this.mode,s.innerHTML||(s.innerHTML=n),e&&(this.submitCallback=e)),window.ga&&ga("登录流程","跳出手机号绑定弹层")}else{var i={truckhomeAccountBinding:1};e&&(i.callback=e),localStorage.setItem("truckhomeAccountBinding",JSON.stringify(i)),setTimeout(function(){location.href=o.OAuthUrl},20)}},hide:function(){s.classList.remove("visible"),location.hash=""},switch:function(){switch(this.mode){case"binding":s.innerHTML='<form method="POST" action="https:///sso.360che.com/index.php?c=login&m=login" autocomplete="off">                <div class="weui_cells_title">卡车之家账号登录</div>                <div class="weui_cells weui_cells_form">                    <div class="weui_cell">                        <div class="weui_cell_hd"><label class="weui_label">用户名</label></div>                        <div class="weui_cell_bd weui_cell_primary">                            <input class="weui_input" type="text" name="username" placeholder="请输入您的用户名/手机号">                        </div>                        <div class="weui_cell_ft">                            <i class="weui_icon_warn"></i>                        </div>                    </div>                    <div class="weui_cell">                        <div class="weui_cell_hd"><label class="weui_label">密码</label></div>                        <div class="weui_cell_bd weui_cell_primary">                            <input class="weui_input" type="password" name="password" placeholder="请输入密码">                        </div>                        <div class="weui_cell_ft">                            <i class="weui_icon_warn"></i>                        </div>                    </div>                </div>                <input type="hidden" name="referer" value="\'+ document.referrer ? document.referrer : location.href +\'" />                <div class="weui_btn_area">                    <a href="javascript:;" class="weui_btn weui_btn_default">取消</a>                    <input type="submit" class="weui_btn weui_btn_primary weui_btn_disabled" value="登录" disabled />                </div>            </form>            <div class="weui_msg">                <div class="weui_extra_area">                    <a href="javascript:;" class="account_switch">手机号码绑定</a>                </div>            </div>',this.mode="signin";break;case"signin":s.innerHTML=n,this.mode="binding"}},error:function(e,i){var t=this;if(this.toptips||(this.toptips=document.createElement("div"),this.toptips.className="weui_toptips weui_warn js_tooltips",this.toptips.style.zIndex="1002",document.body.appendChild(this.toptips)),this.toptips.innerHTML=e,this.toptips.style.display="block",this.errorTimer&&clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){t.toptips.style.display="none"},2e3),i){var a=i.parents(".weui_cell");a&&a.classList.add("weui_cell_warn")}},toast:function(e,i,t){function a(e){return'<p class="weui_toast_content">'+e+"</p>"}if(this._toast||(this._toast=document.createElement("div"),this._toast.innerHTML='<div class="weui_mask_transparent"></div><div class="weui_toast"></div>',document.body.appendChild(this._toast)),i){var n=this._toast.querySelector(".weui_toast");switch(e){case"loading":this._toast.className="weui_loading_toast",n.innerHTML='<div class="weui_loading"><div class="weui_loading_leaf weui_loading_leaf_0"></div><div class="weui_loading_leaf weui_loading_leaf_1"></div><div class="weui_loading_leaf weui_loading_leaf_2"></div><div class="weui_loading_leaf weui_loading_leaf_3"></div><div class="weui_loading_leaf weui_loading_leaf_4"></div><div class="weui_loading_leaf weui_loading_leaf_5"></div><div class="weui_loading_leaf weui_loading_leaf_6"></div><div class="weui_loading_leaf weui_loading_leaf_7"></div><div class="weui_loading_leaf weui_loading_leaf_8"></div><div class="weui_loading_leaf weui_loading_leaf_9"></div><div class="weui_loading_leaf weui_loading_leaf_10"></div><div class="weui_loading_leaf weui_loading_leaf_11"></div></div>'+a(t);break;default:this._toast.className="",n.innerHTML='<i class="weui_icon_toast"></i>'+a(t);var s=this._toast;setTimeout(function(){s.style.display="none"},1e3)}this._toast.style.display="block"}else this._toast.style.display="none"},vcode:function(e){var i=this,t=s.querySelector("form"),a=t.elements.phone,n=t.data.phone,l=new RegExp("^1(([38]\\d)|(4[57])|(5[012356789])|(7[01678]))\\d{8}$");return n?l.test(n)?(this.speed=61,void $.ajax({url:"https://sso.360che.com/index.php?c=phone&m=getPhoneCodeByLogin",data:{tel:t.data.phone},dataType:"jsonp",success:function(t){"err"==t.status?i.error(t.msg):(e.classList.add("disabled"),i.countdown(e))},error:function(){i.error("网络不给力，请稍后重试")}})):void this.error("手机号码格式错误",a):void this.error("请填写手机号",a)},countdown:function(e){var i=this;if(this.countdownTimer&&clearTimeout(this.countdownTimer),1==this.speed)e.classList.remove("disabled"),e.innerHTML="重新获取";else{this.speed-=1;var t=this.speed+"";t=1==t.length?"0"+t:t,e.innerHTML="重新获取("+t+")",this.countdownTimer=setTimeout(function(){i.countdown(e)},1e3)}},onInputHandle:function(){var e=this;s.addEventListener("input",function(i){var t=i.target;if("INPUT"==t.tagName&&("tel"==t.type||"password"==t.type||"text"==t.type)){var a=t.parents(".weui_cell");a&&a.classList.contains("weui_cell_warn")&&a.classList.remove("weui_cell_warn"),e.checkSubmit()}})},checkSubmit:function(){var e=s.querySelector("form"),i=e.querySelector('form input[type="submit"]');switch(this.mode){case"binding":e.data.phone&&11==e.data.phone.length&&e.data.phonecode&&4==e.data.phonecode.length?this.enabled(i):this.disabled(i);break;case"signin":e.data.username&&e.data.password?this.enabled(i):this.disabled(i)}},enabled:function(e){e.disabled=!1,e.classList.remove("weui_btn_disabled")},disabled:function(e){e.disabled=!0,e.classList.add("weui_btn_disabled")},submit:function(e,i){e.preventDefault();var t=i.querySelector('input[type="submit"]'),a=this;this.disabled(t),this.toast("loading",!0,"提交中，请稍后..."),$.ajax({url:i.action,data:i.data,dataType:"jsonp",success:function(e){"ok"==e.status?(a.hide(),a.toast("infor",!0,e.msg),window.location.reload()):(a.enabled(t),a.error(e.msg)),a.toast("loading",!1),window.ga&&ga("登录流程","绑定成功")},error:function(){a.enabled(t),a.error("网络不给力，请稍后重试"),a.toast("loading",!1)}})},cancel:function(){location.hash||o.hide()}};o.init(),s.addEventListener("submit",function(e){var i=e.target;"FORM"==i.tagName&&o.submit(e,i)}),s.addEventListener("click",function(e){var i=e.target;"A"==i.tagName&&("account_switch"==i.className&&o.switch(),"weui_btn weui_btn_default"==i.className&&o.hide()),"SPAN"==i.tagName&&"vcode"==i.className&&o.vcode(i)}),window.addEventListener("hashchange",function(){o.cancel()}),window.truckhomeAccountBinding=o}.call(i,t,i,e))&&(e.exports=a)}if(HTMLElement.prototype.parents||(HTMLElement.prototype.parents=function(e){for(var i,t=this;(t=t.parentNode)&&9!==t.nodeType;)if(1===t.nodeType){if(t.tagName.toLowerCase()===e){i=t;break}if(e.startsWith(".")&&t.classList.contains(e.replace(/\./,""))){i=t;break}if(e.startsWith("#")&&"#"+t.id===e){i=t;break}}return i}),window.define)n();else{var s=document.createElement("script");s.src="https://s.kcimg.cn/public/m/js/t.min.js",s.onload=function(){n()},document.body.appendChild(s)}}()}]);