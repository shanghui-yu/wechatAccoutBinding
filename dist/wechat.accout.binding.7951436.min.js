!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){var n;!function(){function a(){void 0!==(n=function(e,t){var i=document.createElement("style");i.innerText='.truckhome-account-binding{position: fixed;left:0;top:0;width:100%;height:100%;overflow: hidden;background-color: #fbf9fe;z-index: 1001;visibility: hidden;opacity:0;pointer-events: none;-webkit-transform: translate3d(0,100%,0);transform: translate3d(0,100%,0);-webkit-transition: all .2s ease-out;transition: all .2s ease-out}.truckhome-account-binding.visible{-webkit-transform: translate3d(0,0,0);transform: translate3d(0,0,0);opacity: 1;visibility: visible;pointer-events: all;}.weui_vcode .weui_cell_ft .vcode{margin-left: 5px;width:107px;height: 44px;line-height:44px;vertical-align: middle;display:inline-block;color:#fff;font-size: 14px;text-align: center;background:rgba(4,190,2,1)}.weui_vcode .weui_cell_ft .vcode.disabled{color:#999;background: #f5f5f5}.truckhome-account-binding .weui_btn_area{display: -webkit-box;display: -webkit-flex;display: flex;}.truckhome-account-binding .weui_btn_area > *{-webkit-box-flex: 1;-webkit-flex: 1;flex: 1}.truckhome-account-binding .weui_btn_area input[type="submit"]{margin:0 0 0 10px;border-radius: 5px;}.truckhome-account-binding .weui_btn_area input[disabled]{opacity: 1}.truckhome-account-binding .weui_label{width:80px}',document.head.appendChild(i);var n=document.referrer,a=document.referrer,s=document.querySelector("#truckhome_account_binding"),o=document.cookie.match(/AbcfN_unionid=([^;$]+)/);o&&o[1]&&Object.defineProperty(window,"unionid",{writable:!1,value:o[1]}),s||(s=document.createElement("div"),s.className="truckhome-account-binding",s.addEventListener("touchmove",function(e){e.preventDefault()}),document.body.appendChild(s));var c={init:function(){window.bindUserid?this.BindStatus=!0:(this.mode="binding",s.classList.contains("visible")&&s.classList.remove("visible"),this.checkOAuth(),this.onInputHandle())},checkBind:function(){var e=this;t.ajax({url:"//sso.360che.com/?c=user",dataType:"jsonp",success:function(t){if(t.status){e.BindStatus=!1;try{var i=localStorage.getItem("truckhomeAccountBinding");i&&(i=JSON.parse(i),e.show(i.callback||""))}catch(e){}}else e.BindStatus=!0}})},checkOAuth:function(){var e=this;window.unionid?(this.OAuthStatus=!0,this.checkBind()):t.ajax({url:"//sso.360che.com/index.php?c=weChatOauthUrl&m=getAuthUrl",dataType:"jsonp",success:function(t){"err"==t.status?(e.OAuthStatus=!0,e.checkBind()):(e.OAuthStatus=!1,e.OAuthUrl=t.info.url)}})},show:function(e){if(this.OAuthStatus){try{localStorage.getItem("truckhomeAccountBinding")&&localStorage.removeItem("truckhomeAccountBinding")}catch(e){}this.BindStatus?e&&Function.isFunction(e)&&e():(s.classList.add("visible"),location.hash="#"+this.mode,s.innerHTML||(s.innerHTML=a),e&&(this.submitCallback=e)),window.ga&&ga("登录流程","跳出手机号绑定弹层")}else{var t={truckhomeAccountBinding:1};e&&(t.callback=e),localStorage.setItem("truckhomeAccountBinding",JSON.stringify(t)),setTimeout(function(){location.href=c.OAuthUrl},20)}},hide:function(){s.classList.remove("visible"),location.hash=""},switch:function(){switch(this.mode){case"binding":s.innerHTML=n,this.mode="signin";break;case"signin":s.innerHTML=a,this.mode="binding"}},error:function(e,t){var i=this;if(this.toptips||(this.toptips=document.createElement("div"),this.toptips.className="weui_toptips weui_warn js_tooltips",this.toptips.style.zIndex="1002",document.body.appendChild(this.toptips)),this.toptips.innerHTML=e,this.toptips.style.display="block",this.errorTimer&&clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){i.toptips.style.display="none"},2e3),t){var n=t.parents(".weui_cell");n&&n.classList.add("weui_cell_warn")}},toast:function(e,t,i){function n(e){return'<p class="weui_toast_content">'+e+"</p>"}if(this._toast||(this._toast=document.createElement("div"),this._toast.innerHTML='<div class="weui_mask_transparent"></div><div class="weui_toast"></div>',document.body.appendChild(this._toast)),t){var a=this._toast.querySelector(".weui_toast");switch(e){case"loading":this._toast.className="weui_loading_toast",a.innerHTML='<div class="weui_loading"><div class="weui_loading_leaf weui_loading_leaf_0"></div><div class="weui_loading_leaf weui_loading_leaf_1"></div><div class="weui_loading_leaf weui_loading_leaf_2"></div><div class="weui_loading_leaf weui_loading_leaf_3"></div><div class="weui_loading_leaf weui_loading_leaf_4"></div><div class="weui_loading_leaf weui_loading_leaf_5"></div><div class="weui_loading_leaf weui_loading_leaf_6"></div><div class="weui_loading_leaf weui_loading_leaf_7"></div><div class="weui_loading_leaf weui_loading_leaf_8"></div><div class="weui_loading_leaf weui_loading_leaf_9"></div><div class="weui_loading_leaf weui_loading_leaf_10"></div><div class="weui_loading_leaf weui_loading_leaf_11"></div></div>'+n(i);break;default:this._toast.className="",a.innerHTML='<i class="weui_icon_toast"></i>'+n(i);var s=this._toast;setTimeout(function(){s.style.display="none"},1e3)}this._toast.style.display="block"}else this._toast.style.display="none"},vcode:function(e){var i=this,n=s.querySelector("form"),a=n.elements.tel,o=n.data.tel,c=new RegExp(a.pattern);return o?c.test(o)?(this.speed=61,void t.ajax({url:"//sso.360che.com/index.php?c=phone&m=getPhoneCodeByLogin",data:{tel:n.data.tel},dataType:"jsonp",success:function(t){"err"==t.status?i.error(t.msg):(e.classList.add("disabled"),i.countdown(e))},error:function(){i.error("网络不给力，请稍后重试")}})):void this.error("手机号码格式错误",a):void this.error("请填写手机号",a)},countdown:function(e){var t=this;if(this.countdownTimer&&clearTimeout(this.countdownTimer),1==this.speed)e.classList.remove("disabled"),e.innerHTML="重新获取";else{this.speed-=1;var i=this.speed+"";i=1==i.length?"0"+i:i,e.innerHTML="重新获取("+i+")",this.countdownTimer=setTimeout(function(){t.countdown(e)},1e3)}},onInputHandle:function(){var e=this;s.addEventListener("input",function(t){var i=t.target;if("INPUT"==i.tagName&&("tel"==i.type||"password"==i.type||"text"==i.type)){var n=i.parents(".weui_cell");n&&n.classList.contains("weui_cell_warn")&&n.classList.remove("weui_cell_warn"),e.checkSubmit()}})},checkSubmit:function(){var e=s.querySelector("form"),t=e.querySelector('form input[type="submit"]');switch(this.mode){case"binding":e.data.tel&&11==e.data.tel.length&&e.data.yzm&&4==e.data.yzm.length?this.enabled(t):this.disabled(t);break;case"signin":e.data.username&&e.data.password?this.enabled(t):this.disabled(t)}},enabled:function(e){e.disabled=!1,e.classList.remove("weui_btn_disabled")},disabled:function(e){e.disabled=!0,e.classList.add("weui_btn_disabled")},submit:function(e,i){e.preventDefault();var n=i.querySelector('input[type="submit"]'),a=this;this.disabled(n),this.toast("loading",!0,"提交中，请稍后..."),t.ajax({url:i.action,data:i.data,dataType:"jsonp",success:function(e){"ok"==e.status?(a.hide(),a.toast("infor",!0,e.msg),window.location.reload()):(a.enabled(n),a.error(e.msg)),a.toast("loading",!1),window.ga&&ga("登录流程","绑定成功")},error:function(){a.enabled(n),a.error("网络不给力，请稍后重试"),a.toast("loading",!1)}})},cancel:function(){location.hash||c.hide()}};c.init(),s.addEventListener("submit",function(e){var t=e.target;"FORM"==t.tagName&&c.submit(e,t)}),s.addEventListener("click",function(e){var t=e.target;"A"==t.tagName&&("account_switch"==t.className&&c.switch(),"weui_btn weui_btn_default"==t.className&&c.hide()),"SPAN"==t.tagName&&"vcode"==t.className&&c.vcode(t)}),window.addEventListener("hashchange",function(){c.cancel()}),t.truckhomeAccountBinding=c,window.truckhomeAccountBinding=c}.call(t,i,t,e))&&(e.exports=n)}if(HTMLElement.prototype.parents||(HTMLElement.prototype.parents=function(e){for(var t,i=this;(i=i.parentNode)&&9!==i.nodeType;)if(1===i.nodeType){if(i.tagName.toLowerCase()===e){t=i;break}if(e.startsWith(".")&&i.classList.contains(e.replace(/\./,""))){t=i;break}if(e.startsWith("#")&&"#"+i.id===e){t=i;break}}return t}),window.define)a();else{var s=document.createElement("script");s.src="//s.kcimg.cn/public/m/js/t.min.js",s.onload=function(){a()},document.body.appendChild(s)}}()}]);