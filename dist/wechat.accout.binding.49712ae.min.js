!function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){var n;!function(){function a(){void 0!==(n=function(t,e){var i=document.createElement("style");i.innerText='.truckhome-account-binding{position: fixed;left:0;top:0;width:100%;height:100%;overflow: hidden;background-color: #fbf9fe;z-index: 1001;visibility: hidden;opacity:0;pointer-events: none;-webkit-transform: translate3d(0,100%,0);transform: translate3d(0,100%,0);-webkit-transition: all .2s ease-out;transition: all .2s ease-out}.truckhome-account-binding.visible{-webkit-transform: translate3d(0,0,0);transform: translate3d(0,0,0);opacity: 1;visibility: visible;pointer-events: all;}.weui_vcode .weui_cell_ft .vcode{margin-left: 5px;width:107px;height: 44px;line-height:44px;vertical-align: middle;display:inline-block;color:#fff;font-size: 14px;text-align: center;background:rgba(4,190,2,1)}.weui_vcode .weui_cell_ft .vcode.disabled{color:#999;background: #f5f5f5}.truckhome-account-binding .weui_btn_area{display: -webkit-box;display: -webkit-flex;display: flex;}.truckhome-account-binding .weui_btn_area > *{-webkit-box-flex: 1;-webkit-flex: 1;flex: 1}.truckhome-account-binding .weui_btn_area input[type="submit"]{margin:0 0 0 10px;border-radius: 5px;}.truckhome-account-binding .weui_btn_area input[disabled]{opacity: 1}.truckhome-account-binding .weui_label{width:80px}',document.head.appendChild(i);var n=document.referrer,a=document.referrer,s=document.querySelector("#truckhome_account_binding"),o=document.cookie.match(/AbcfN_unionid=([^;$]+)/);o&&o[1]&&Object.defineProperty(window,"unionid",{writable:!1,value:o[1]}),s||(s=document.createElement("div"),s.className="truckhome-account-binding",s.addEventListener("touchmove",function(t){t.preventDefault()}),document.body.appendChild(s));var c={init:function(){window.bindUserid?this.BindStatus=!0:(this.mode="binding",s.classList.contains("visible")&&s.classList.remove("visible"),this.checkOAuth(),this.onInputHandle())},checkBind:function(){var t=this;$.ajax({url:"https://sso.360che.com/?c=user",dataType:"jsonp",success:function(e){if(e.status){t.BindStatus=!1;try{var i=localStorage.getItem("truckhomeAccountBinding");i&&(i=JSON.parse(i),t.show(i.callback||""))}catch(t){}}else t.BindStatus=!0}})},checkOAuth:function(){var t=this;window.unionid?(this.OAuthStatus=!0,this.checkBind()):$.ajax({url:"https://sso.360che.com/index.php?c=weChatOauthUrl&m=getAuthUrl",dataType:"jsonp",success:function(e){"err"==e.status?(t.OAuthStatus=!0,t.checkBind()):(t.OAuthStatus=!1,t.OAuthUrl=e.info.url)}})},show:function(t){if(this.OAuthStatus){try{localStorage.getItem("truckhomeAccountBinding")&&localStorage.removeItem("truckhomeAccountBinding")}catch(t){}this.BindStatus?t&&Function.isFunction(t)&&t():(s.classList.add("visible"),location.hash="#"+this.mode,s.innerHTML||(s.innerHTML=a),t&&(this.submitCallback=t)),window.ga&&ga("登录流程","跳出手机号绑定弹层")}else{var e={truckhomeAccountBinding:1};t&&(e.callback=t),localStorage.setItem("truckhomeAccountBinding",JSON.stringify(e)),setTimeout(function(){location.href=c.OAuthUrl},20)}},hide:function(){s.classList.remove("visible"),location.hash=""},switch:function(){switch(this.mode){case"binding":s.innerHTML=n,this.mode="signin";break;case"signin":s.innerHTML=a,this.mode="binding"}},error:function(t,e){var i=this;if(this.toptips||(this.toptips=document.createElement("div"),this.toptips.className="weui_toptips weui_warn js_tooltips",this.toptips.style.zIndex="1002",document.body.appendChild(this.toptips)),this.toptips.innerHTML=t,this.toptips.style.display="block",this.errorTimer&&clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){i.toptips.style.display="none"},2e3),e){var n=e.parents(".weui_cell");n&&n.classList.add("weui_cell_warn")}},toast:function(t,e,i){function n(t){return'<p class="weui_toast_content">'+t+"</p>"}if(this._toast||(this._toast=document.createElement("div"),this._toast.innerHTML='<div class="weui_mask_transparent"></div><div class="weui_toast"></div>',document.body.appendChild(this._toast)),e){var a=this._toast.querySelector(".weui_toast");switch(t){case"loading":this._toast.className="weui_loading_toast",a.innerHTML='<div class="weui_loading"><div class="weui_loading_leaf weui_loading_leaf_0"></div><div class="weui_loading_leaf weui_loading_leaf_1"></div><div class="weui_loading_leaf weui_loading_leaf_2"></div><div class="weui_loading_leaf weui_loading_leaf_3"></div><div class="weui_loading_leaf weui_loading_leaf_4"></div><div class="weui_loading_leaf weui_loading_leaf_5"></div><div class="weui_loading_leaf weui_loading_leaf_6"></div><div class="weui_loading_leaf weui_loading_leaf_7"></div><div class="weui_loading_leaf weui_loading_leaf_8"></div><div class="weui_loading_leaf weui_loading_leaf_9"></div><div class="weui_loading_leaf weui_loading_leaf_10"></div><div class="weui_loading_leaf weui_loading_leaf_11"></div></div>'+n(i);break;default:this._toast.className="",a.innerHTML='<i class="weui_icon_toast"></i>'+n(i);var s=this._toast;setTimeout(function(){s.style.display="none"},1e3)}this._toast.style.display="block"}else this._toast.style.display="none"},vcode:function(t){var e=this,i=s.querySelector("form"),n=i.elements.tel,a=i.data.tel,o=new RegExp(n.pattern);return a?o.test(a)?(this.speed=61,void $.ajax({url:"https://sso.360che.com/index.php?c=phone&m=getPhoneCodeByLogin",data:{tel:i.data.tel},dataType:"jsonp",success:function(i){"err"==i.status?e.error(i.msg):(t.classList.add("disabled"),e.countdown(t))},error:function(){e.error("网络不给力，请稍后重试")}})):void this.error("手机号码格式错误",n):void this.error("请填写手机号",n)},countdown:function(t){var e=this;if(this.countdownTimer&&clearTimeout(this.countdownTimer),1==this.speed)t.classList.remove("disabled"),t.innerHTML="重新获取";else{this.speed-=1;var i=this.speed+"";i=1==i.length?"0"+i:i,t.innerHTML="重新获取("+i+")",this.countdownTimer=setTimeout(function(){e.countdown(t)},1e3)}},onInputHandle:function(){var t=this;s.addEventListener("input",function(e){var i=e.target;if("INPUT"==i.tagName&&("tel"==i.type||"password"==i.type||"text"==i.type)){var n=i.parents(".weui_cell");n&&n.classList.contains("weui_cell_warn")&&n.classList.remove("weui_cell_warn"),t.checkSubmit()}})},checkSubmit:function(){var t=s.querySelector("form"),e=t.querySelector('form input[type="submit"]');switch(this.mode){case"binding":t.data.tel&&11==t.data.tel.length&&t.data.yzm&&4==t.data.yzm.length?this.enabled(e):this.disabled(e);break;case"signin":t.data.username&&t.data.password?this.enabled(e):this.disabled(e)}},enabled:function(t){t.disabled=!1,t.classList.remove("weui_btn_disabled")},disabled:function(t){t.disabled=!0,t.classList.add("weui_btn_disabled")},submit:function(t,e){t.preventDefault();var i=e.querySelector('input[type="submit"]'),n=this;this.disabled(i),this.toast("loading",!0,"提交中，请稍后..."),$.ajax({url:e.action,data:e.data,dataType:"jsonp",success:function(t){"ok"==t.status?(n.hide(),n.toast("infor",!0,t.msg),window.location.reload()):(n.enabled(i),n.error(t.msg)),n.toast("loading",!1),window.ga&&ga("登录流程","绑定成功")},error:function(){n.enabled(i),n.error("网络不给力，请稍后重试"),n.toast("loading",!1)}})},cancel:function(){location.hash||c.hide()}};c.init(),s.addEventListener("submit",function(t){var e=t.target;"FORM"==e.tagName&&c.submit(t,e)}),s.addEventListener("click",function(t){var e=t.target;"A"==e.tagName&&("account_switch"==e.className&&c.switch(),"weui_btn weui_btn_default"==e.className&&c.hide()),"SPAN"==e.tagName&&"vcode"==e.className&&c.vcode(e)}),window.addEventListener("hashchange",function(){c.cancel()}),window.truckhomeAccountBinding=c}.call(e,i,e,t))&&(t.exports=n)}if(HTMLElement.prototype.parents||(HTMLElement.prototype.parents=function(t){for(var e,i=this;(i=i.parentNode)&&9!==i.nodeType;)if(1===i.nodeType){if(i.tagName.toLowerCase()===t){e=i;break}if(t.startsWith(".")&&i.classList.contains(t.replace(/\./,""))){e=i;break}if(t.startsWith("#")&&"#"+i.id===t){e=i;break}}return e}),window.define)a();else{var s=document.createElement("script");s.src="https://s.kcimg.cn/public/m/js/t.min.js",s.onload=function(){a()},document.body.appendChild(s)}}()}]);